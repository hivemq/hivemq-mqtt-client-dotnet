"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[1876],{4161(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"hivemqclient","title":"HiveMQClient","description":"Overview","source":"@site/docs/hivemqclient.md","sourceDirName":".","slug":"/hivemqclient","permalink":"/hivemq-mqtt-client-dotnet/docs/hivemqclient","draft":false,"unlisted":false,"editUrl":"https://github.com/hivemq/hivemq-mqtt-client-dotnet/tree/main/Documentation/docs/hivemqclient.md","tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"sidebar_position":22},"sidebar":"docsSidebar","previous":{"title":"Quickstart","permalink":"/hivemq-mqtt-client-dotnet/docs/quickstart"},"next":{"title":"RawClient (Beta)","permalink":"/hivemq-mqtt-client-dotnet/docs/rawclient"}}');var t=i(4848),c=i(8453);const r={sidebar_position:22},l="HiveMQClient",a={},o=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:3},{value:"HiveMQClient vs RawClient",id:"hivemqclient-vs-rawclient",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"Connecting",id:"connecting",level:2},{value:"With Default Options",id:"with-default-options",level:3},{value:"With Specific Options",id:"with-specific-options",level:3},{value:"With Automatic Reconnect",id:"with-automatic-reconnect",level:3},{value:"Using WebSockets",id:"using-websockets",level:3},{value:"With Connect Options Override",id:"with-connect-options-override",level:3},{value:"Checking Connection State",id:"checking-connection-state",level:3},{value:"Publishing Messages",id:"publishing-messages",level:2},{value:"Simple Publish",id:"simple-publish",level:3},{value:"With MQTT5PublishMessage",id:"with-mqtt5publishmessage",level:3},{value:"With PublishMessageBuilder",id:"with-publishmessagebuilder",level:3},{value:"With Cancellation Token",id:"with-cancellation-token",level:3},{value:"Subscribing to Topics",id:"subscribing-to-topics",level:2},{value:"Simple Subscribe",id:"simple-subscribe",level:3},{value:"With SubscribeOptions",id:"with-subscribeoptions",level:3},{value:"Accessing Tracked Subscriptions",id:"accessing-tracked-subscriptions",level:3},{value:"Per-Subscription Callbacks",id:"per-subscription-callbacks",level:3},{value:"Receiving Messages",id:"receiving-messages",level:2},{value:"Global Message Handler",id:"global-message-handler",level:3},{value:"Message Handler as Method",id:"message-handler-as-method",level:3},{value:"Unsubscribing",id:"unsubscribing",level:2},{value:"By Topic String",id:"by-topic-string",level:3},{value:"By Subscription Object",id:"by-subscription-object",level:3},{value:"By List of Subscriptions",id:"by-list-of-subscriptions",level:3},{value:"With UnsubscribeOptions",id:"with-unsubscribeoptions",level:3},{value:"Disconnecting",id:"disconnecting",level:2},{value:"Events",id:"events",level:2},{value:"Lifecycle Events",id:"lifecycle-events",level:3},{value:"Packet-Level Events",id:"packet-level-events",level:3},{value:"LocalStore",id:"localstore",level:2},{value:"Resource Cleanup",id:"resource-cleanup",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"hivemqclient",children:"HiveMQClient"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"HiveMQClient"})," is the full-featured MQTT 5.0 client for .NET applications. It provides a rich set of features including subscription management, per-subscription callbacks, automatic reconnect, and a comprehensive event system."]}),"\n",(0,t.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Subscription tracking"}),(0,t.jsxs)(n.td,{children:["Automatically tracks active subscriptions in ",(0,t.jsx)(n.code,{children:"client.Subscriptions"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Per-subscription callbacks"}),(0,t.jsx)(n.td,{children:"Route messages to specific handlers based on topic"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Automatic reconnect"}),(0,t.jsx)(n.td,{children:"Built-in reconnection with exponential backoff"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Message routing"}),(0,t.jsx)(n.td,{children:"Incoming messages are matched to subscriptions and routed accordingly"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Full MQTT 5.0 support"}),(0,t.jsx)(n.td,{children:"All MQTT 5.0 features including user properties, topic aliases, and more"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"hivemqclient-vs-rawclient",children:"HiveMQClient vs RawClient"}),"\n",(0,t.jsxs)(n.p,{children:["For most applications, ",(0,t.jsx)(n.code,{children:"HiveMQClient"})," is the recommended choice. Use ",(0,t.jsx)(n.code,{children:"RawClient"})," only when you need maximum performance with minimal overhead."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"HiveMQClient"}),(0,t.jsx)(n.th,{children:"RawClient (Beta)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Subscription state tracking"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Per-subscription callbacks"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"client.Subscriptions"})," property"]}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Message routing by subscription"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Automatic reconnect"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Unsubscribe by topic string"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Performance"}),(0,t.jsx)(n.td,{children:"Standard"}),(0,t.jsx)(n.td,{children:"Optimized"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using HiveMQtt.Client;\nusing HiveMQtt.MQTT5.Types;\n\n// Create a client\nvar client = new HiveMQClient();\n\n// Setup message handler BEFORE subscribing\nclient.OnMessageReceived += (sender, args) =>\n{\n    Console.WriteLine($"Message received on {args.PublishMessage.Topic}: {args.PublishMessage.PayloadAsString}");\n};\n\n// Connect to the broker\nvar connectResult = await client.ConnectAsync().ConfigureAwait(false);\n\n// Subscribe to a topic (tracked in client.Subscriptions)\nawait client.SubscribeAsync("my/topic", QualityOfService.AtLeastOnceDelivery).ConfigureAwait(false);\n\n// Publish a message\nawait client.PublishAsync("my/topic", "Hello from HiveMQClient!").ConfigureAwait(false);\n\n// Disconnect when done\nawait client.DisconnectAsync().ConfigureAwait(false);\nclient.Dispose();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"connecting",children:"Connecting"}),"\n",(0,t.jsx)(n.h3,{id:"with-default-options",children:"With Default Options"}),"\n",(0,t.jsxs)(n.p,{children:["Without any options, the client will attempt to connect to ",(0,t.jsx)(n.code,{children:"localhost"})," on port 1883."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using HiveMQtt.Client;\n\nvar client = new HiveMQClient();\nvar connectResult = await client.ConnectAsync().ConfigureAwait(false);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"with-specific-options",children:"With Specific Options"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"HiveMQClientOptionsBuilder"})," to configure the client:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var options = new HiveMQClientOptionsBuilder()\n    .WithBroker("broker.hivemq.com")\n    .WithPort(8883)\n    .WithUseTls(true)\n    .WithClientId("my-client-id")\n    .Build();\n\nvar client = new HiveMQClient(options);\nvar connectResult = await client.ConnectAsync().ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-automatic-reconnect",children:"With Automatic Reconnect"}),"\n",(0,t.jsx)(n.p,{children:"Enable automatic reconnection to handle network interruptions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var options = new HiveMQClientOptionsBuilder()\n    .WithBroker("broker.hivemq.com")\n    .WithAutomaticReconnect(true)\n    .Build();\n\nvar client = new HiveMQClient(options);\nvar connectResult = await client.ConnectAsync().ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.p,{children:"The automatic reconnect uses an exponential backoff strategy:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Initial delay: 5 seconds"}),"\n",(0,t.jsx)(n.li,{children:"Maximum delay: 1 minute"}),"\n",(0,t.jsx)(n.li,{children:"Attempts: Indefinite until successful"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"using-websockets",children:"Using WebSockets"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var options = new HiveMQClientOptionsBuilder()\n    .WithWebSocketServer("ws://broker.hivemq.com:8000/mqtt")\n    .Build();\n\nvar client = new HiveMQClient(options);\nvar connectResult = await client.ConnectAsync().ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-connect-options-override",children:"With Connect Options Override"}),"\n",(0,t.jsx)(n.p,{children:"Override certain options at connect time:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"var client = new HiveMQClient(options);\n\nvar connectOptions = new ConnectOptions\n{\n    KeepAlive = 120,\n    SessionExpiryInterval = 600,\n    CleanStart = false,\n};\n\nvar connectResult = await client.ConnectAsync(connectOptions).ConfigureAwait(false);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"checking-connection-state",children:"Checking Connection State"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'if (client.IsConnected())\n{\n    Console.WriteLine("Client is connected");\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"publishing-messages",children:"Publishing Messages"}),"\n",(0,t.jsx)(n.h3,{id:"simple-publish",children:"Simple Publish"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Publish with string payload (default QoS 0)\nvar result = await client.PublishAsync("topic/example", "Hello World!").ConfigureAwait(false);\n\n// Publish with specific QoS\nvar result = await client.PublishAsync("topic/example", "Hello World!", QualityOfService.AtLeastOnceDelivery).ConfigureAwait(false);\n\n// Publish with byte array payload\nvar payload = Encoding.UTF8.GetBytes("Binary payload");\nvar result = await client.PublishAsync("topic/example", payload, QualityOfService.ExactlyOnceDelivery).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-mqtt5publishmessage",children:"With MQTT5PublishMessage"}),"\n",(0,t.jsx)(n.p,{children:"For full control over the publish message:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var message = new MQTT5PublishMessage\n{\n    Topic = "topic/example",\n    Payload = Encoding.UTF8.GetBytes("Advanced message"),\n    QoS = QualityOfService.AtLeastOnceDelivery,\n    Retain = true,\n    ContentType = "application/json",\n    ResponseTopic = "response/topic",\n};\n\nmessage.UserProperties.Add("Client-Geo", "-33.8688, 151.2093");\n\nvar result = await client.PublishAsync(message).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-publishmessagebuilder",children:"With PublishMessageBuilder"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var publishMessage = new PublishMessageBuilder()\n    .WithTopic("topic/example")\n    .WithPayload("{\\"HiveMQ\\": \\"rocks\\"}")\n    .WithContentType("application/json")\n    .WithQualityOfServiceLevel(QualityOfService.AtLeastOnceDelivery)\n    .WithRetainFlag(true)\n    .WithResponseTopic("response/topic")\n    .WithUserProperty("property1", "value1")\n    .Build();\n\nvar result = await client.PublishAsync(publishMessage).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-cancellation-token",children:"With Cancellation Token"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var cts = new CancellationTokenSource(TimeSpan.FromSeconds(30));\n\ntry\n{\n    var result = await client.PublishAsync(message, cts.Token).ConfigureAwait(false);\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine("Publish operation was cancelled");\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"subscribing-to-topics",children:"Subscribing to Topics"}),"\n",(0,t.jsx)(n.h3,{id:"simple-subscribe",children:"Simple Subscribe"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Subscribe with default options (QoS 0)\nawait client.SubscribeAsync("my/topic").ConfigureAwait(false);\n\n// Subscribe with specific QoS\nawait client.SubscribeAsync("my/topic", QualityOfService.AtLeastOnceDelivery).ConfigureAwait(false);\n\n// Subscribe with additional options\nawait client.SubscribeAsync(\n    "my/topic",\n    QualityOfService.ExactlyOnceDelivery,\n    noLocal: true,\n    retainAsPublished: true,\n    retainHandling: RetainHandling.SendAtSubscribe\n).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-subscribeoptions",children:"With SubscribeOptions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var subscribeOptions = new SubscribeOptionsBuilder()\n    .WithSubscription("topic1", QualityOfService.AtLeastOnceDelivery)\n    .WithSubscription("topic2", QualityOfService.ExactlyOnceDelivery)\n    .WithUserProperty("Client-Type", "HiveMQClient")\n    .Build();\n\nvar result = await client.SubscribeAsync(subscribeOptions).ConfigureAwait(false);\n\n// Check results\nforeach (var subscription in result.Subscriptions)\n{\n    Console.WriteLine($"Subscribed to {subscription.TopicFilter.Topic}: {subscription.SubscribeReasonCode}");\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"accessing-tracked-subscriptions",children:"Accessing Tracked Subscriptions"}),"\n",(0,t.jsx)(n.p,{children:"The client automatically tracks all active subscriptions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// View all current subscriptions\nforeach (var subscription in client.Subscriptions)\n{\n    Console.WriteLine($"Active subscription: {subscription.TopicFilter.Topic} (QoS: {subscription.TopicFilter.QoS})");\n}\n\n// Get a specific subscription by topic\nvar subscription = client.GetSubscriptionByTopic("my/topic");\nif (subscription != null)\n{\n    Console.WriteLine($"Found subscription: {subscription.TopicFilter.Topic}");\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"per-subscription-callbacks",children:"Per-Subscription Callbacks"}),"\n",(0,t.jsx)(n.p,{children:"Route messages to specific handlers based on topic:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Define a handler for a specific topic\nvoid SensorHandler(object? sender, OnMessageReceivedEventArgs args)\n{\n    Console.WriteLine($"Sensor data: {args.PublishMessage.PayloadAsString}");\n}\n\n// Subscribe with a per-subscription callback\nvar options = new SubscribeOptionsBuilder()\n    .WithSubscription(\n        new TopicFilter("sensors/temperature", QualityOfService.AtLeastOnceDelivery),\n        SensorHandler)\n    .Build();\n\nawait client.SubscribeAsync(options).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.p,{children:"Or with inline lambda:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var options = new SubscribeOptionsBuilder()\n    .WithSubscription(\n        new TopicFilter("sensors/temperature", QualityOfService.AtLeastOnceDelivery),\n        (sender, args) =>\n        {\n            Console.WriteLine($"Temperature: {args.PublishMessage.PayloadAsString}");\n        })\n    .WithSubscription(\n        new TopicFilter("sensors/humidity", QualityOfService.AtLeastOnceDelivery),\n        (sender, args) =>\n        {\n            Console.WriteLine($"Humidity: {args.PublishMessage.PayloadAsString}");\n        })\n    .Build();\n\nawait client.SubscribeAsync(options).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h2,{id:"receiving-messages",children:"Receiving Messages"}),"\n",(0,t.jsx)(n.h3,{id:"global-message-handler",children:"Global Message Handler"}),"\n",(0,t.jsx)(n.p,{children:"Set up a global handler for all incoming messages:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'client.OnMessageReceived += (sender, args) =>\n{\n    var message = args.PublishMessage;\n\n    Console.WriteLine($"Topic: {message.Topic}");\n    Console.WriteLine($"Payload: {message.PayloadAsString}");\n    Console.WriteLine($"QoS: {message.QoS}");\n    Console.WriteLine($"Retain: {message.Retain}");\n};\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"Important",type:"tip",children:(0,t.jsxs)(n.p,{children:["Set your message handlers ",(0,t.jsx)(n.strong,{children:"before"})," subscribing to topics. Once connected, the broker may start sending messages immediately, especially retained messages."]})}),"\n",(0,t.jsx)(n.h3,{id:"message-handler-as-method",children:"Message Handler as Method"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'private static void MessageHandler(object? sender, OnMessageReceivedEventArgs args)\n{\n    Console.WriteLine($"Message received: {args.PublishMessage.PayloadAsString}");\n}\n\n// Register the handler\nclient.OnMessageReceived += MessageHandler;\nawait client.ConnectAsync();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"unsubscribing",children:"Unsubscribing"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"HiveMQClient"})," provides multiple ways to unsubscribe:"]}),"\n",(0,t.jsx)(n.h3,{id:"by-topic-string",children:"By Topic String"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Unsubscribe using the topic string\nvar result = await client.UnsubscribeAsync("my/topic").ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"by-subscription-object",children:"By Subscription Object"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Get a subscription from the tracked list\nvar subscription = client.GetSubscriptionByTopic("my/topic");\n\nif (subscription != null)\n{\n    var result = await client.UnsubscribeAsync(subscription).ConfigureAwait(false);\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"by-list-of-subscriptions",children:"By List of Subscriptions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Unsubscribe from multiple topics at once\nvar subscriptionsToRemove = client.Subscriptions\n    .Where(s => s.TopicFilter.Topic.StartsWith("sensors/"))\n    .ToList();\n\nvar result = await client.UnsubscribeAsync(subscriptionsToRemove).ConfigureAwait(false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"with-unsubscribeoptions",children:"With UnsubscribeOptions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"var unsubscribeOptions = new UnsubscribeOptionsBuilder()\n    .WithSubscription(subscription1)\n    .WithSubscription(subscription2)\n    .Build();\n\nvar result = await client.UnsubscribeAsync(unsubscribeOptions).ConfigureAwait(false);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"disconnecting",children:"Disconnecting"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Simple disconnect\nawait client.DisconnectAsync().ConfigureAwait(false);\n\n// Disconnect with options\nvar disconnectOptions = new DisconnectOptions\n{\n    ReasonCode = DisconnectReasonCode.NormalDisconnection,\n};\n\nawait client.DisconnectAsync(disconnectOptions).ConfigureAwait(false);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"HiveMQClient"})," provides a comprehensive event system for monitoring and customizing client behavior."]}),"\n",(0,t.jsx)(n.h3,{id:"lifecycle-events",children:"Lifecycle Events"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'client.BeforeConnect += (sender, args) => Console.WriteLine("About to connect...");\nclient.AfterConnect += (sender, args) => Console.WriteLine($"Connected: {args.ConnectResult.ReasonCode}");\nclient.BeforeDisconnect += (sender, args) => Console.WriteLine("About to disconnect...");\nclient.AfterDisconnect += (sender, args) => Console.WriteLine($"Disconnected (clean: {args.CleanDisconnect})");\nclient.BeforeSubscribe += (sender, args) => Console.WriteLine("About to subscribe...");\nclient.AfterSubscribe += (sender, args) => Console.WriteLine("Subscribed!");\nclient.BeforeUnsubscribe += (sender, args) => Console.WriteLine("About to unsubscribe...");\nclient.AfterUnsubscribe += (sender, args) => Console.WriteLine("Unsubscribed!");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"packet-level-events",children:"Packet-Level Events"}),"\n",(0,t.jsx)(n.p,{children:"For protocol-level debugging and monitoring:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Connection packets\nclient.OnConnectSent += (sender, args) => Console.WriteLine("CONNECT sent");\nclient.OnConnAckReceived += (sender, args) => Console.WriteLine("CONNACK received");\nclient.OnDisconnectSent += (sender, args) => Console.WriteLine("DISCONNECT sent");\nclient.OnDisconnectReceived += (sender, args) => Console.WriteLine("DISCONNECT received from broker");\n\n// Keep-alive packets\nclient.OnPingReqSent += (sender, args) => Console.WriteLine("PINGREQ sent");\nclient.OnPingRespReceived += (sender, args) => Console.WriteLine("PINGRESP received");\n\n// Subscription packets\nclient.OnSubscribeSent += (sender, args) => Console.WriteLine("SUBSCRIBE sent");\nclient.OnSubAckReceived += (sender, args) => Console.WriteLine("SUBACK received");\nclient.OnUnsubscribeSent += (sender, args) => Console.WriteLine("UNSUBSCRIBE sent");\nclient.OnUnsubAckReceived += (sender, args) => Console.WriteLine("UNSUBACK received");\n\n// Publish packets\nclient.OnPublishSent += (sender, args) => Console.WriteLine($"PUBLISH sent: {args.PublishPacket.Message.Topic}");\nclient.OnPublishReceived += (sender, args) => Console.WriteLine($"PUBLISH received: {args.PublishPacket.Message.Topic}");\n\n// QoS 1 acknowledgment\nclient.OnPubAckSent += (sender, args) => Console.WriteLine("PUBACK sent");\nclient.OnPubAckReceived += (sender, args) => Console.WriteLine("PUBACK received");\n\n// QoS 2 handshake\nclient.OnPubRecSent += (sender, args) => Console.WriteLine("PUBREC sent");\nclient.OnPubRecReceived += (sender, args) => Console.WriteLine("PUBREC received");\nclient.OnPubRelSent += (sender, args) => Console.WriteLine("PUBREL sent");\nclient.OnPubRelReceived += (sender, args) => Console.WriteLine("PUBREL received");\nclient.OnPubCompSent += (sender, args) => Console.WriteLine("PUBCOMP sent");\nclient.OnPubCompReceived += (sender, args) => Console.WriteLine("PUBCOMP received");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"localstore",children:"LocalStore"}),"\n",(0,t.jsxs)(n.p,{children:["The client provides a ",(0,t.jsx)(n.code,{children:"LocalStore"})," dictionary for storing client-specific data:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Store application-specific data\nclient.LocalStore["device-id"] = "sensor-001";\nclient.LocalStore["location"] = "building-a";\n\n// Retrieve later\nvar deviceId = client.LocalStore["device-id"];\n'})}),"\n",(0,t.jsx)(n.h2,{id:"resource-cleanup",children:"Resource Cleanup"}),"\n",(0,t.jsx)(n.p,{children:"Always dispose of the client when done:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Using pattern (recommended)\nawait using var client = new HiveMQClient(options);\nawait client.ConnectAsync();\n// ... use client ...\nawait client.DisconnectAsync();\n\n// Or explicit dispose\nvar client = new HiveMQClient(options);\ntry\n{\n    await client.ConnectAsync();\n    // ... use client ...\n    await client.DisconnectAsync();\n}\nfinally\n{\n    client.Dispose();\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using HiveMQtt.Client;\nusing HiveMQtt.MQTT5.Types;\n\n// Configure the client\nvar options = new HiveMQClientOptionsBuilder()\n    .WithBroker("broker.hivemq.com")\n    .WithPort(1883)\n    .WithClientId("hivemqclient-example")\n    .WithAutomaticReconnect(true)\n    .Build();\n\nvar client = new HiveMQClient(options);\n\n// Setup global message handler\nclient.OnMessageReceived += (sender, args) =>\n{\n    Console.WriteLine($"[{args.PublishMessage.Topic}]: {args.PublishMessage.PayloadAsString}");\n};\n\n// Track connection state changes\nclient.AfterConnect += (sender, args) => Console.WriteLine("Connected to broker");\nclient.AfterDisconnect += (sender, args) => Console.WriteLine("Disconnected from broker");\n\ntry\n{\n    // Connect\n    var connectResult = await client.ConnectAsync().ConfigureAwait(false);\n\n    if (connectResult.ReasonCode != ConnAckReasonCode.Success)\n    {\n        Console.WriteLine($"Connection failed: {connectResult.ReasonCode}");\n        return;\n    }\n\n    // Subscribe with per-subscription callbacks\n    var subscribeOptions = new SubscribeOptionsBuilder()\n        .WithSubscription(\n            new TopicFilter("sensors/temperature", QualityOfService.AtLeastOnceDelivery),\n            (sender, args) => Console.WriteLine($"Temperature: {args.PublishMessage.PayloadAsString}"))\n        .WithSubscription(\n            new TopicFilter("sensors/humidity", QualityOfService.AtLeastOnceDelivery),\n            (sender, args) => Console.WriteLine($"Humidity: {args.PublishMessage.PayloadAsString}"))\n        .Build();\n\n    await client.SubscribeAsync(subscribeOptions).ConfigureAwait(false);\n\n    // View tracked subscriptions\n    Console.WriteLine($"Active subscriptions: {client.Subscriptions.Count}");\n\n    // Publish messages\n    for (var i = 0; i < 10; i++)\n    {\n        await client.PublishAsync("sensors/temperature", $"{20 + i}\xb0C").ConfigureAwait(false);\n        await Task.Delay(100);\n    }\n\n    // Wait for messages\n    await Task.Delay(1000);\n\n    // Unsubscribe by topic\n    await client.UnsubscribeAsync("sensors/temperature").ConfigureAwait(false);\n\n    // Disconnect\n    await client.DisconnectAsync().ConfigureAwait(false);\n}\nfinally\n{\n    client.Dispose();\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/Client/HiveMQClient.cs",children:"HiveMQClient.cs"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/Client/IHiveMQClient.cs",children:"IHiveMQClient.cs"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/rawclient",children:"RawClient"})," - Low-level client for performance-critical scenarios"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/connecting",children:"Connecting"})," - Detailed connection documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/publishing",children:"Publishing Messages"})," - Detailed publishing documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/subscribing",children:"Subscribing to Topics"})," - Detailed subscription documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/events",children:"Events"})," - Event system documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/reference/automatic_reconnect",children:"Automatic Reconnect"})," - Reconnection behavior details"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/reference/client_options_builder",children:"HiveMQClientOptionsBuilder Reference"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>r,x:()=>l});var s=i(6540);const t={},c=s.createContext(t);function r(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);